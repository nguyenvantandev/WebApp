package co.jp.myapp.controller;

import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import co.jp.myapp.dao.ConnectionDao;
import co.jp.myapp.model.KanjiVal;

/**
 * Servlet implementation class KanjiController
 */
@WebServlet("/KanjiController")
public class KanjiController extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    public KanjiController() {
        super();
        // TODO Auto-generated constructor stub
    }
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		response.setContentType("text/html; charset=UTF-8");
		request.setCharacterEncoding("UTF-8");
	
		String actionName = request.getParameter("actionName");
		String searchVal = request.getParameter("searchVal");
		
		ConnectionDao con = new ConnectionDao();
		Connection connection = null;
		PreparedStatement preparedStatement = null;
		ResultSet rs = null;
		ArrayList<KanjiVal> list = new ArrayList<KanjiVal>();
		ArrayList<String> getlist = new ArrayList<String>();
		if("èâä˙ï\é¶".equals(actionName)){
			String sql = "SELECT kanji FROM kanji_list";
			try{
				connection = con.connect();
				preparedStatement= connection.prepareStatement(sql);
				rs = preparedStatement.executeQuery();
				while(rs.next()){
					getlist.add(rs.getString("kanji"));
				}
			}catch(Exception e){
				e.printStackTrace();
			}
			KanjiVal val = new KanjiVal();
			List<String> list1 = new ArrayList<String>();
			list1 = getlist.subList(0, 10);
			val.setLocal1(list1.get(0));
			val.setLocal2(list1.get(1));
			val.setLocal3(list1.get(2));
			val.setLocal4(list1.get(3));
			val.setLocal5(list1.get(4));
			val.setLocal6(list1.get(5));
			val.setLocal7(list1.get(6));
			val.setLocal8(list1.get(7));
			val.setLocal9(list1.get(8));
			val.setLocal10(list1.get(9));
			list.add(val);
			List<String> list2 = new ArrayList<String>();
			list2 = getlist.subList(10, 20);
			val.setLocal1(list2.get(0));
			val.setLocal2(list2.get(1));
			val.setLocal3(list2.get(2));
			val.setLocal4(list2.get(3));
			val.setLocal5(list2.get(4));
			val.setLocal6(list2.get(5));
			val.setLocal7(list2.get(6));
			val.setLocal8(list2.get(7));
			val.setLocal9(list2.get(8));
			val.setLocal10(list2.get(9));
			list.add(val);
			List<String> list3 = new ArrayList<String>();
			list3 = getlist.subList(20, 30);
			val.setLocal1(list3.get(0));
			val.setLocal2(list3.get(1));
			val.setLocal3(list3.get(2));
			val.setLocal4(list3.get(3));
			val.setLocal5(list3.get(4));
			val.setLocal6(list3.get(5));
			val.setLocal7(list3.get(6));
			val.setLocal8(list3.get(7));
			val.setLocal9(list3.get(8));
			val.setLocal10(list3.get(9));
			list.add(val);
			System.out.println(getlist.size());
			System.out.println(list.size());
			request.setAttribute("Valshow", list);
			request.setAttribute("actionVal", "1");
			RequestDispatcher rd = request.getRequestDispatcher("Kanji.jsp");
			rd.forward(request, response);
			return;
		}
	}
}
